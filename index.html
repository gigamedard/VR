<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>VR Workspace (Client)</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>
    <style>
      #info-box {
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 20px;
        background: white;
        border-radius: 8px;
        border: none;
        font-size: 16px;
        font-family: sans-serif;
        z-index: 9999;
        text-align: center;
      }
      #pc-stream-video {
        display: none;
      }
    </style>
  </head>

  <body>
    <div id="info-box">V 1.0.01 Connexion au serveur...</div>

    <a-scene>
      <a-assets>
        <video id="pc-stream-video" autoplay loop="true" playsinline crossorigin="anonymous"></video>
      </a-assets>
      <a-entity camera look-controls></a-entity>

      <a-plane id="screen"
               width="2"
               height="1.125"
               position="0 1.5 -2.5"
               src="#pc-stream-video">
      </a-plane>
    </a-scene>

    <script>
      const infoBox = document.getElementById("info-box");
      const videoElement = document.getElementById("pc-stream-video");

      // PeerJS est OK, ce log Ã©tait bon !
      const peer = new Peer(null, {
        debug: 2 
      });

      peer.on('open', (id) => {
        infoBox.innerHTML = `Entrez cet ID sur le PC : <br><strong>${id}</strong>`;
        console.log('Mon ID PeerJS est: ' + id);
      });

      peer.on('call', (call) => {
        call.answer();
        call.on('stream', (remoteStream) => {
          videoElement.srcObject = remoteStream;

          // C'est la correction NÂ°2 (clic pour dÃ©marrer)
          infoBox.innerHTML = "Stream reÃ§u ! ðŸš€<br><strong>(Tapez ici pour dÃ©marrer)</strong>";
          infoBox.style.cursor = "pointer"; 

          infoBox.addEventListener('click', () => {
            videoElement.play();
            infoBox.style.display = 'none'; 
          }, { once: true });
        });
      });

      peer.on('error', (err) => {
        infoBox.innerText = `Erreur: ${err.type}`;
        console.error(err);
      });
    </script>
  </body>
</html>